<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 4 Activity 3 | Portfolio Stat 764</title>

    <meta name="author" content="Gabriel Hintz" />
  
   <meta name="description" content="Portfolio STAT764 Spring 2024" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 4 Activity 3 | Portfolio Stat 764" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Portfolio STAT764 Spring 2024" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Activity 3 | Portfolio Stat 764" />
  
  <meta name="twitter:description" content="Portfolio STAT764 Spring 2024" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.7.0/transition.js"></script>
    <script src="libs/bs3compat-0.7.0/tabs.js"></script>
    <script src="libs/bs3compat-0.7.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
    <link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-1.3.1/leaflet.js"></script>
    <link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4-2.6.2/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
    <script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
    <script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Portfolio Stat 764</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="activity-3" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Activity 3</h1>
<div id="upload-data" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Upload data</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="activity-3.html#cb22-1" tabindex="-1"></a><span class="co"># Upload data</span></span>
<span id="cb22-2"><a href="activity-3.html#cb22-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.dropbox.com/scl/fi/9ymxt900s77uq50ca6dgc/Enders-et-al.-2018-data.csv?rlkey=0rxjwleenhgu0gvzow5p0x9xf&amp;dl=1&quot;</span></span>
<span id="cb22-3"><a href="activity-3.html#cb22-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span>
<span id="cb22-4"><a href="activity-3.html#cb22-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="activity-3.html#cb22-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">presence =</span> <span class="fu">ifelse</span>(EGA <span class="sc">!=</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="co"># Keep only the data on bird cherry-oat aphid</span></span>
<span id="cb22-6"><a href="activity-3.html#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="activity-3.html#cb22-7" tabindex="-1"></a><span class="co"># Download KS shapefile</span></span>
<span id="cb22-8"><a href="activity-3.html#cb22-8" tabindex="-1"></a>ks <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">getData</span>(<span class="at">name=</span><span class="st">&quot;GADM&quot;</span>, <span class="at">country=</span><span class="st">&quot;USA&quot;</span>, <span class="at">level=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="activity-3.html#cb22-9" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href="activity-3.html#cb22-10" tabindex="-1"></a>  <span class="fu">filter</span>(NAME_1 <span class="sc">==</span> <span class="st">&#39;Kansas&#39;</span>)</span>
<span id="cb22-11"><a href="activity-3.html#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="activity-3.html#cb22-12" tabindex="-1"></a>df_sf <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&#39;long&#39;</span>, <span class="st">&#39;lat&#39;</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(ks))</span></code></pre></div>
</div>
<div id="upload-covariates" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Upload covariates</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="activity-3.html#cb23-1" tabindex="-1"></a>url.nlcd <span class="ot">&lt;-</span> <span class="st">&quot;https://www.dropbox.com/scl/fi/ew7yzm93aes7l8l37cn65/KS_2011_NLCD.img?rlkey=60ahyvxhq18gt0yr47tuq5fig&amp;dl=1&quot;</span></span>
<span id="cb23-2"><a href="activity-3.html#cb23-2" tabindex="-1"></a>rl.nlcd2011 <span class="ot">&lt;-</span> <span class="fu">raster</span>(url.nlcd)</span>
<span id="cb23-3"><a href="activity-3.html#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="activity-3.html#cb23-4" tabindex="-1"></a><span class="fu">plot</span>(rl.nlcd2011)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="activity-3.html#cb24-1" tabindex="-1"></a></span>
<span id="cb24-2"><a href="activity-3.html#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="activity-3.html#cb24-3" tabindex="-1"></a><span class="co"># Make raster file that contains pixels with value of 1 if grassland and </span></span>
<span id="cb24-4"><a href="activity-3.html#cb24-4" tabindex="-1"></a><span class="co"># zero if other type of land cover.</span></span>
<span id="cb24-5"><a href="activity-3.html#cb24-5" tabindex="-1"></a><span class="co"># NLCD legend can be found here: https://www.mrlc.gov/data/legends/national-land-cover-database-2011-nlcd2011-legend</span></span>
<span id="cb24-6"><a href="activity-3.html#cb24-6" tabindex="-1"></a>rl.nlcd.grass <span class="ot">&lt;-</span> rl.nlcd2011</span>
<span id="cb24-7"><a href="activity-3.html#cb24-7" tabindex="-1"></a>rl.nlcd.grass[] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rl.nlcd.grass[]<span class="sc">==</span><span class="dv">71</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb24-8"><a href="activity-3.html#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="activity-3.html#cb24-9" tabindex="-1"></a><span class="fu">plot</span>(rl.nlcd.grass)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="activity-3.html#cb25-1" tabindex="-1"></a></span>
<span id="cb25-2"><a href="activity-3.html#cb25-2" tabindex="-1"></a>pts.sample<span class="ot">&lt;-</span> df</span>
<span id="cb25-3"><a href="activity-3.html#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="activity-3.html#cb25-4" tabindex="-1"></a><span class="fu">coordinates</span>(pts.sample) <span class="ot">=</span><span class="er">~</span> long <span class="sc">+</span> lat</span>
<span id="cb25-5"><a href="activity-3.html#cb25-5" tabindex="-1"></a><span class="fu">proj4string</span>(pts.sample) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;</span>)</span>
<span id="cb25-6"><a href="activity-3.html#cb25-6" tabindex="-1"></a></span>
<span id="cb25-7"><a href="activity-3.html#cb25-7" tabindex="-1"></a><span class="co"># Calculate percentage of land area that is grassland within 5 km of sampled location</span></span>
<span id="cb25-8"><a href="activity-3.html#cb25-8" tabindex="-1"></a>df<span class="sc">$</span>grass.perc <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">extract</span>(rl.nlcd.grass,pts.sample,<span class="at">buffer=</span><span class="dv">5000</span>),mean))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb25-9"><a href="activity-3.html#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="activity-3.html#cb25-10" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>grass.perc,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;% grassland within </span><span class="sc">\n</span><span class="st">5 km at sample location&quot;</span>)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
</div>
<div id="for-the-data-on-the-abundance-of-english-grain-aphids-propose-three-different-statistical-models-or-machine-learning-approach-that-are-capable-of-predicting-the-number-of-english-grain-aphids-at-any-location-within-the-state-of-kansas-at-any-time-for-the-years-2014-and-2015.-make-sure-to-write-out-the-three-statistical-models-using-formal-notation-and-fully-describe-each-component-using-words." class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> For the data on the abundance of English grain aphids, propose three different statistical models (or machine learning approach) that are capable of predicting the number of English grain aphids at any location within the state of Kansas at any time for the years 2014 and 2015. Make sure to write out the three statistical models using formal notation and fully describe each component using words.</h2>
<p><em>Model 1</em></p>
<p>Data model <span class="math display">\[Z = y\]</span> Process model Using Poisson distribution</p>
<p><span class="math display">\[[y|\lambda] = Poisson(\lambda) \]</span></p>
<p><span class="math display">\[\eta_s\sim MUN(0, \sigma)\]</span> <span class="math display">\[\eta_t\sim MVN(0, \sigma)\]</span>
<span class="math display">\[E(y)=e^{\beta_0+\beta_1\cdot X + \eta_s+\eta_t}\]</span></p>
<p><em>Model 2</em></p>
<p>Data model</p>
<p><span class="math display">\[Z = y\]</span> Process model Using Negative binomial distribution</p>
<p><span class="math display">\[[y|r,p] = NB(r, p)\]</span> <span class="math display">\[\eta_s\sim MVN(0, \sigma)\]</span>
<span class="math display">\[\eta_t\sim  MVN(0, \sigma)\]</span>
<span class="math display">\[E(y)=e^{\beta_0+\beta_1\cdot X + \eta_s+\eta_t}\]</span></p>
<p><em>Model 3</em></p>
<p>Data model</p>
<p><span class="math display">\[Z = y\]</span> Process model Using zero inflated poisson distribution</p>
<p><span class="math display">\[[y|p, \lambda]=ZIP(p,\lambda)\]</span> <span class="math display">\[\eta_s\sim MVN(0, \sigma^2)\]</span>
<span class="math display">\[P(y=0) = p\cdot e^{-0} + (1-p) \cdot e^{-{\lambda}}\]</span>
<span class="math display">\[P(y = k) = (1-p) \cdot \frac{(e^{-{\lambda}}{\lambda^k})}{k!}, k \in N\]</span>
<span class="math display">\[{\lambda} &gt; 0, p \in (0,1)\]</span>
<span class="math display">\[E(y)=e^{\beta_0+\beta_1\cdot X + \eta_s+\eta_t}\]</span></p>
</div>
<div id="for-the-three-statistical-models-you-proposed-in-question-1-propose-a-way-to-measure-the-accuracy-and-perhaps-the-calibration-of-predictions." class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> For the three statistical models you proposed in question #1, propose a way to measure the accuracy (and perhaps the calibration) of predictions.</h2>
<p>RMSE and MAE and AIC.</p>
</div>
<div id="fit-the-three-statistical-models-you-proposed-in-question-1-to-the-english-grain-aphid-abundance-data." class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Fit the three statistical models you proposed in question #1 to the English grain aphid abundance data.</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="activity-3.html#cb26-1" tabindex="-1"></a></span>
<span id="cb26-2"><a href="activity-3.html#cb26-2" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb26-3"><a href="activity-3.html#cb26-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ks)<span class="sc">+</span></span>
<span id="cb26-4"><a href="activity-3.html#cb26-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> df_sf, <span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">size =</span> EGA, <span class="at">fill =</span> <span class="fu">factor</span>(presence)))<span class="sc">+</span></span>
<span id="cb26-5"><a href="activity-3.html#cb26-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb26-6"><a href="activity-3.html#cb26-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="data-split" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Data Split</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="activity-3.html#cb27-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb27-2"><a href="activity-3.html#cb27-2" tabindex="-1"></a>df.sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>), <span class="fu">nrow</span>(df), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb27-3"><a href="activity-3.html#cb27-3" tabindex="-1"></a>df.train <span class="ot">&lt;-</span> df[df.sample,]</span>
<span id="cb27-4"><a href="activity-3.html#cb27-4" tabindex="-1"></a>df.test <span class="ot">&lt;-</span> df[<span class="sc">!</span>df.sample,]</span></code></pre></div>
<div id="model-1" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Model 1</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="activity-3.html#cb28-1" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(EGA <span class="sc">~</span> grass.perc <span class="sc">+</span> <span class="fu">as.factor</span>(year) <span class="sc">+</span> <span class="fu">s</span>(long,lat, <span class="at">bs =</span> <span class="st">&quot;gp&quot;</span>), </span>
<span id="cb28-2"><a href="activity-3.html#cb28-2" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> df.train)</span>
<span id="cb28-3"><a href="activity-3.html#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="activity-3.html#cb28-4" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb28-5"><a href="activity-3.html#cb28-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-6"><a href="activity-3.html#cb28-6" tabindex="-1"></a><span class="co">#&gt; Family: poisson </span></span>
<span id="cb28-7"><a href="activity-3.html#cb28-7" tabindex="-1"></a><span class="co">#&gt; Link function: log </span></span>
<span id="cb28-8"><a href="activity-3.html#cb28-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-9"><a href="activity-3.html#cb28-9" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb28-10"><a href="activity-3.html#cb28-10" tabindex="-1"></a><span class="co">#&gt; EGA ~ grass.perc + as.factor(year) + s(long, lat, bs = &quot;gp&quot;)</span></span>
<span id="cb28-11"><a href="activity-3.html#cb28-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-12"><a href="activity-3.html#cb28-12" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb28-13"><a href="activity-3.html#cb28-13" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb28-14"><a href="activity-3.html#cb28-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)         -4.072721   0.508579  -8.008 1.17e-15</span></span>
<span id="cb28-15"><a href="activity-3.html#cb28-15" tabindex="-1"></a><span class="co">#&gt; grass.perc          -0.034166   0.001664 -20.538  &lt; 2e-16</span></span>
<span id="cb28-16"><a href="activity-3.html#cb28-16" tabindex="-1"></a><span class="co">#&gt; as.factor(year)2015  6.148542   0.500663  12.281  &lt; 2e-16</span></span>
<span id="cb28-17"><a href="activity-3.html#cb28-17" tabindex="-1"></a><span class="co">#&gt;                        </span></span>
<span id="cb28-18"><a href="activity-3.html#cb28-18" tabindex="-1"></a><span class="co">#&gt; (Intercept)         ***</span></span>
<span id="cb28-19"><a href="activity-3.html#cb28-19" tabindex="-1"></a><span class="co">#&gt; grass.perc          ***</span></span>
<span id="cb28-20"><a href="activity-3.html#cb28-20" tabindex="-1"></a><span class="co">#&gt; as.factor(year)2015 ***</span></span>
<span id="cb28-21"><a href="activity-3.html#cb28-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-22"><a href="activity-3.html#cb28-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb28-23"><a href="activity-3.html#cb28-23" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-24"><a href="activity-3.html#cb28-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-25"><a href="activity-3.html#cb28-25" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb28-26"><a href="activity-3.html#cb28-26" tabindex="-1"></a><span class="co">#&gt;               edf Ref.df Chi.sq p-value    </span></span>
<span id="cb28-27"><a href="activity-3.html#cb28-27" tabindex="-1"></a><span class="co">#&gt; s(long,lat) 31.45   31.8   5663  &lt;2e-16 ***</span></span>
<span id="cb28-28"><a href="activity-3.html#cb28-28" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb28-29"><a href="activity-3.html#cb28-29" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb28-30"><a href="activity-3.html#cb28-30" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb28-31"><a href="activity-3.html#cb28-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-32"><a href="activity-3.html#cb28-32" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =   0.67   Deviance explained = 81.1%</span></span>
<span id="cb28-33"><a href="activity-3.html#cb28-33" tabindex="-1"></a><span class="co">#&gt; UBRE = 17.558  Scale est. = 1         n = 178</span></span></code></pre></div>
</div>
<div id="model-2" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Model 2</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="activity-3.html#cb29-1" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(EGA <span class="sc">~</span> grass.perc <span class="sc">+</span> <span class="fu">as.factor</span>(year) <span class="sc">+</span> <span class="fu">s</span>(long,lat, <span class="at">bs =</span> <span class="st">&quot;gp&quot;</span>), </span>
<span id="cb29-2"><a href="activity-3.html#cb29-2" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">nb</span>(<span class="at">theta =</span> <span class="cn">NULL</span>,<span class="at">link =</span> <span class="st">&quot;log&quot;</span>), <span class="at">data =</span> df.train)</span>
<span id="cb29-3"><a href="activity-3.html#cb29-3" tabindex="-1"></a></span>
<span id="cb29-4"><a href="activity-3.html#cb29-4" tabindex="-1"></a><span class="fu">summary</span>(m2)</span>
<span id="cb29-5"><a href="activity-3.html#cb29-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-6"><a href="activity-3.html#cb29-6" tabindex="-1"></a><span class="co">#&gt; Family: Negative Binomial(0.653) </span></span>
<span id="cb29-7"><a href="activity-3.html#cb29-7" tabindex="-1"></a><span class="co">#&gt; Link function: log </span></span>
<span id="cb29-8"><a href="activity-3.html#cb29-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-9"><a href="activity-3.html#cb29-9" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb29-10"><a href="activity-3.html#cb29-10" tabindex="-1"></a><span class="co">#&gt; EGA ~ grass.perc + as.factor(year) + s(long, lat, bs = &quot;gp&quot;)</span></span>
<span id="cb29-11"><a href="activity-3.html#cb29-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-12"><a href="activity-3.html#cb29-12" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb29-13"><a href="activity-3.html#cb29-13" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb29-14"><a href="activity-3.html#cb29-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)         -3.29390    0.61890  -5.322 1.03e-07</span></span>
<span id="cb29-15"><a href="activity-3.html#cb29-15" tabindex="-1"></a><span class="co">#&gt; grass.perc          -0.00141    0.00678  -0.208    0.835</span></span>
<span id="cb29-16"><a href="activity-3.html#cb29-16" tabindex="-1"></a><span class="co">#&gt; as.factor(year)2015  5.67995    0.59656   9.521  &lt; 2e-16</span></span>
<span id="cb29-17"><a href="activity-3.html#cb29-17" tabindex="-1"></a><span class="co">#&gt;                        </span></span>
<span id="cb29-18"><a href="activity-3.html#cb29-18" tabindex="-1"></a><span class="co">#&gt; (Intercept)         ***</span></span>
<span id="cb29-19"><a href="activity-3.html#cb29-19" tabindex="-1"></a><span class="co">#&gt; grass.perc             </span></span>
<span id="cb29-20"><a href="activity-3.html#cb29-20" tabindex="-1"></a><span class="co">#&gt; as.factor(year)2015 ***</span></span>
<span id="cb29-21"><a href="activity-3.html#cb29-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb29-22"><a href="activity-3.html#cb29-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb29-23"><a href="activity-3.html#cb29-23" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb29-24"><a href="activity-3.html#cb29-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-25"><a href="activity-3.html#cb29-25" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb29-26"><a href="activity-3.html#cb29-26" tabindex="-1"></a><span class="co">#&gt;               edf Ref.df Chi.sq p-value    </span></span>
<span id="cb29-27"><a href="activity-3.html#cb29-27" tabindex="-1"></a><span class="co">#&gt; s(long,lat) 8.356  11.02  224.3  &lt;2e-16 ***</span></span>
<span id="cb29-28"><a href="activity-3.html#cb29-28" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb29-29"><a href="activity-3.html#cb29-29" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb29-30"><a href="activity-3.html#cb29-30" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb29-31"><a href="activity-3.html#cb29-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-32"><a href="activity-3.html#cb29-32" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =  0.263   Deviance explained = 72.7%</span></span>
<span id="cb29-33"><a href="activity-3.html#cb29-33" tabindex="-1"></a><span class="co">#&gt; -REML = 493.04  Scale est. = 1         n = 178</span></span></code></pre></div>
</div>
<div id="model-3" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Model 3</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="activity-3.html#cb30-1" tabindex="-1"></a></span>
<span id="cb30-2"><a href="activity-3.html#cb30-2" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>(EGA <span class="sc">~</span> grass.perc <span class="sc">+</span> <span class="fu">as.factor</span>(year) <span class="sc">+</span> <span class="fu">s</span>(long,lat, <span class="at">bs =</span> <span class="st">&quot;gp&quot;</span>), <span class="sc">~</span> grass.perc <span class="sc">+</span> <span class="fu">s</span>(long,lat, <span class="at">bs =</span> <span class="st">&quot;gp&quot;</span>)), </span>
<span id="cb30-3"><a href="activity-3.html#cb30-3" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">ziplss</span>(), <span class="at">data =</span> df.train)</span>
<span id="cb30-4"><a href="activity-3.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="activity-3.html#cb30-5" tabindex="-1"></a><span class="fu">summary</span>(m3)</span>
<span id="cb30-6"><a href="activity-3.html#cb30-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-7"><a href="activity-3.html#cb30-7" tabindex="-1"></a><span class="co">#&gt; Family: ziplss </span></span>
<span id="cb30-8"><a href="activity-3.html#cb30-8" tabindex="-1"></a><span class="co">#&gt; Link function: identity identity </span></span>
<span id="cb30-9"><a href="activity-3.html#cb30-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-10"><a href="activity-3.html#cb30-10" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb30-11"><a href="activity-3.html#cb30-11" tabindex="-1"></a><span class="co">#&gt; EGA ~ grass.perc + as.factor(year) + s(long, lat, bs = &quot;gp&quot;)</span></span>
<span id="cb30-12"><a href="activity-3.html#cb30-12" tabindex="-1"></a><span class="co">#&gt; ~grass.perc + s(long, lat, bs = &quot;gp&quot;)</span></span>
<span id="cb30-13"><a href="activity-3.html#cb30-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-14"><a href="activity-3.html#cb30-14" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb30-15"><a href="activity-3.html#cb30-15" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb30-16"><a href="activity-3.html#cb30-16" tabindex="-1"></a><span class="co">#&gt; (Intercept)         -3.561202   0.936080  -3.804 0.000142</span></span>
<span id="cb30-17"><a href="activity-3.html#cb30-17" tabindex="-1"></a><span class="co">#&gt; grass.perc          -0.039519   0.001732 -22.811  &lt; 2e-16</span></span>
<span id="cb30-18"><a href="activity-3.html#cb30-18" tabindex="-1"></a><span class="co">#&gt; as.factor(year)2015  5.546180   0.927371   5.981 2.22e-09</span></span>
<span id="cb30-19"><a href="activity-3.html#cb30-19" tabindex="-1"></a><span class="co">#&gt; (Intercept).1       -0.038220   0.186544  -0.205 0.837661</span></span>
<span id="cb30-20"><a href="activity-3.html#cb30-20" tabindex="-1"></a><span class="co">#&gt; grass.perc.1         0.001405   0.005252   0.267 0.789118</span></span>
<span id="cb30-21"><a href="activity-3.html#cb30-21" tabindex="-1"></a><span class="co">#&gt;                        </span></span>
<span id="cb30-22"><a href="activity-3.html#cb30-22" tabindex="-1"></a><span class="co">#&gt; (Intercept)         ***</span></span>
<span id="cb30-23"><a href="activity-3.html#cb30-23" tabindex="-1"></a><span class="co">#&gt; grass.perc          ***</span></span>
<span id="cb30-24"><a href="activity-3.html#cb30-24" tabindex="-1"></a><span class="co">#&gt; as.factor(year)2015 ***</span></span>
<span id="cb30-25"><a href="activity-3.html#cb30-25" tabindex="-1"></a><span class="co">#&gt; (Intercept).1          </span></span>
<span id="cb30-26"><a href="activity-3.html#cb30-26" tabindex="-1"></a><span class="co">#&gt; grass.perc.1           </span></span>
<span id="cb30-27"><a href="activity-3.html#cb30-27" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb30-28"><a href="activity-3.html#cb30-28" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb30-29"><a href="activity-3.html#cb30-29" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb30-30"><a href="activity-3.html#cb30-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-31"><a href="activity-3.html#cb30-31" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb30-32"><a href="activity-3.html#cb30-32" tabindex="-1"></a><span class="co">#&gt;                  edf Ref.df  Chi.sq p-value    </span></span>
<span id="cb30-33"><a href="activity-3.html#cb30-33" tabindex="-1"></a><span class="co">#&gt; s(long,lat)   30.937 31.330 4819.22 &lt; 2e-16 ***</span></span>
<span id="cb30-34"><a href="activity-3.html#cb30-34" tabindex="-1"></a><span class="co">#&gt; s.1(long,lat)  2.828  3.463   16.34 0.00192 ** </span></span>
<span id="cb30-35"><a href="activity-3.html#cb30-35" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb30-36"><a href="activity-3.html#cb30-36" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb30-37"><a href="activity-3.html#cb30-37" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb30-38"><a href="activity-3.html#cb30-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb30-39"><a href="activity-3.html#cb30-39" tabindex="-1"></a><span class="co">#&gt; Deviance explained = 78.1%</span></span>
<span id="cb30-40"><a href="activity-3.html#cb30-40" tabindex="-1"></a><span class="co">#&gt; -REML = 1765.8  Scale est. = 1         n = 178</span></span></code></pre></div>
</div>
</div>
<div id="create-points-for-prediction" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Create points for prediction</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="activity-3.html#cb31-1" tabindex="-1"></a><span class="do">####</span></span>
<span id="cb31-2"><a href="activity-3.html#cb31-2" tabindex="-1"></a>rl.E.y <span class="ot">&lt;-</span> <span class="fu">raster</span>(,<span class="at">nrow=</span><span class="dv">30</span>,<span class="at">ncols=</span><span class="dv">30</span>,<span class="at">ext=</span><span class="fu">extent</span>(ks),<span class="at">crs=</span><span class="fu">crs</span>(ks))</span>
<span id="cb31-3"><a href="activity-3.html#cb31-3" tabindex="-1"></a>newPoints <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">long =</span> <span class="fu">xyFromCell</span>(rl.E.y,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y[]))[,<span class="dv">1</span>],</span>
<span id="cb31-4"><a href="activity-3.html#cb31-4" tabindex="-1"></a>                      <span class="at">lat =</span> <span class="fu">xyFromCell</span>(rl.E.y,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y[]))[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="activity-3.html#cb31-5" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&#39;long&#39;</span>, <span class="st">&#39;lat&#39;</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(ks)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="activity-3.html#cb31-6" tabindex="-1"></a>  <span class="fu">st_filter</span>(ks) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="activity-3.html#cb31-7" tabindex="-1"></a>  <span class="fu">cross_join</span>(<span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&#39;2014&#39;</span>, <span class="st">&#39;2015&#39;</span>))))</span>
<span id="cb31-8"><a href="activity-3.html#cb31-8" tabindex="-1"></a></span>
<span id="cb31-9"><a href="activity-3.html#cb31-9" tabindex="-1"></a>newPoints<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(newPoints<span class="sc">$</span>geometry)[,<span class="dv">2</span>]</span>
<span id="cb31-10"><a href="activity-3.html#cb31-10" tabindex="-1"></a>newPoints<span class="sc">$</span>long <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(newPoints<span class="sc">$</span>geometry)[,<span class="dv">1</span>]</span>
<span id="cb31-11"><a href="activity-3.html#cb31-11" tabindex="-1"></a></span>
<span id="cb31-12"><a href="activity-3.html#cb31-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb31-13"><a href="activity-3.html#cb31-13" tabindex="-1"></a><span class="co"># newPoints &lt;- st_sample(ks, size = 1000, type = &quot;regular&quot;) %&gt;%</span></span>
<span id="cb31-14"><a href="activity-3.html#cb31-14" tabindex="-1"></a><span class="co">#   as(., &#39;Spatial&#39;) %&gt;% as.data.frame() %&gt;%</span></span>
<span id="cb31-15"><a href="activity-3.html#cb31-15" tabindex="-1"></a><span class="co">#     rename(&quot;long&quot; = &#39;coords.x1&#39;,</span></span>
<span id="cb31-16"><a href="activity-3.html#cb31-16" tabindex="-1"></a><span class="co">#          &#39;lat&#39; = &#39;coords.x2&#39;) %&gt;%</span></span>
<span id="cb31-17"><a href="activity-3.html#cb31-17" tabindex="-1"></a><span class="co">#   cross_join(data.frame(year = as.factor(c(&#39;2014&#39;, &#39;2015&#39;))))</span></span>
<span id="cb31-18"><a href="activity-3.html#cb31-18" tabindex="-1"></a></span>
<span id="cb31-19"><a href="activity-3.html#cb31-19" tabindex="-1"></a>    </span>
<span id="cb31-20"><a href="activity-3.html#cb31-20" tabindex="-1"></a>pts.sample<span class="ot">&lt;-</span> newPoints</span>
<span id="cb31-21"><a href="activity-3.html#cb31-21" tabindex="-1"></a></span>
<span id="cb31-22"><a href="activity-3.html#cb31-22" tabindex="-1"></a><span class="fu">coordinates</span>(pts.sample) <span class="ot">=</span><span class="er">~</span> long <span class="sc">+</span> lat</span>
<span id="cb31-23"><a href="activity-3.html#cb31-23" tabindex="-1"></a><span class="fu">proj4string</span>(pts.sample) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;</span>)</span>
<span id="cb31-24"><a href="activity-3.html#cb31-24" tabindex="-1"></a></span>
<span id="cb31-25"><a href="activity-3.html#cb31-25" tabindex="-1"></a>newPoints<span class="sc">$</span>grass.perc <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">extract</span>(rl.nlcd.grass,pts.sample,<span class="at">buffer=</span><span class="dv">5000</span>),mean))<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="activity-3.html#cb32-1" tabindex="-1"></a><span class="co"># Fit mod 1</span></span>
<span id="cb32-2"><a href="activity-3.html#cb32-2" tabindex="-1"></a>newPoints<span class="sc">$</span>y_pred1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1, newPoints, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb32-3"><a href="activity-3.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="activity-3.html#cb32-4" tabindex="-1"></a><span class="co"># m1.pred &lt;- st_as_sf(newPoints, coords = c(&#39;long&#39;, &#39;lat&#39;), crs = st_crs(ks),</span></span>
<span id="cb32-5"><a href="activity-3.html#cb32-5" tabindex="-1"></a><span class="co">#                     agr = &#39;constant&#39;) </span></span>
<span id="cb32-6"><a href="activity-3.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="activity-3.html#cb32-7" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb32-8"><a href="activity-3.html#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="activity-3.html#cb32-9" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> y_pred1))<span class="sc">+</span></span>
<span id="cb32-10"><a href="activity-3.html#cb32-10" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ks, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)<span class="sc">+</span></span>
<span id="cb32-11"><a href="activity-3.html#cb32-11" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>()<span class="sc">+</span></span>
<span id="cb32-12"><a href="activity-3.html#cb32-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Longitude&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Latitude&#39;</span>)<span class="sc">+</span></span>
<span id="cb32-13"><a href="activity-3.html#cb32-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb32-14"><a href="activity-3.html#cb32-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb32-15"><a href="activity-3.html#cb32-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="activity-3.html#cb33-1" tabindex="-1"></a><span class="co"># Fit mod 2</span></span>
<span id="cb33-2"><a href="activity-3.html#cb33-2" tabindex="-1"></a>newPoints<span class="sc">$</span>y_pred2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2, newPoints, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb33-3"><a href="activity-3.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="activity-3.html#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="activity-3.html#cb33-5" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb33-6"><a href="activity-3.html#cb33-6" tabindex="-1"></a></span>
<span id="cb33-7"><a href="activity-3.html#cb33-7" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> y_pred2))<span class="sc">+</span></span>
<span id="cb33-8"><a href="activity-3.html#cb33-8" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ks, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)<span class="sc">+</span></span>
<span id="cb33-9"><a href="activity-3.html#cb33-9" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>()<span class="sc">+</span></span>
<span id="cb33-10"><a href="activity-3.html#cb33-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Longitude&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Latitude&#39;</span>)<span class="sc">+</span></span>
<span id="cb33-11"><a href="activity-3.html#cb33-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb33-12"><a href="activity-3.html#cb33-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb33-13"><a href="activity-3.html#cb33-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="activity-3.html#cb34-1" tabindex="-1"></a><span class="co"># Fit mod 3</span></span>
<span id="cb34-2"><a href="activity-3.html#cb34-2" tabindex="-1"></a>newPoints<span class="sc">$</span>y_pred3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m3, newPoints, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb34-3"><a href="activity-3.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="activity-3.html#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="activity-3.html#cb34-5" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb34-6"><a href="activity-3.html#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="activity-3.html#cb34-7" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> y_pred3))<span class="sc">+</span></span>
<span id="cb34-8"><a href="activity-3.html#cb34-8" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> ks, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>)<span class="sc">+</span></span>
<span id="cb34-9"><a href="activity-3.html#cb34-9" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>()<span class="sc">+</span></span>
<span id="cb34-10"><a href="activity-3.html#cb34-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Longitude&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Latitude&#39;</span>)<span class="sc">+</span></span>
<span id="cb34-11"><a href="activity-3.html#cb34-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb34-12"><a href="activity-3.html#cb34-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb34-13"><a href="activity-3.html#cb34-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="for-the-three-models-you-fit-in-question-3-which-model-makes-the-most-accurate-predictions-how-good-is-the-best-model-in-real-world-terms-remember-we-are-trying-to-predict-the-number-of-english-grain-aphids-which-is-a-count" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> For the three models you fit in question #3, which model makes the most accurate predictions? How good is the best model in real world terms? Remember we are trying to predict the number of English grain aphids, which is a count!</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="activity-3.html#cb35-1" tabindex="-1"></a>rmse.m1 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(df.test<span class="sc">$</span>EGA, <span class="fu">as.numeric</span>(<span class="fu">predict</span>(m1, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb35-2"><a href="activity-3.html#cb35-2" tabindex="-1"></a>mae.m1 <span class="ot">&lt;-</span> <span class="fu">mae</span>(df.test<span class="sc">$</span>EGA, <span class="fu">as.numeric</span>(<span class="fu">predict</span>(m1, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb35-3"><a href="activity-3.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="activity-3.html#cb35-4" tabindex="-1"></a>rmse.m2 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(df.test<span class="sc">$</span>EGA, <span class="fu">as.numeric</span>(<span class="fu">predict</span>(m2, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb35-5"><a href="activity-3.html#cb35-5" tabindex="-1"></a>mae.m2 <span class="ot">&lt;-</span> <span class="fu">mae</span>(df.test<span class="sc">$</span>EGA, <span class="fu">as.numeric</span>(<span class="fu">predict</span>(m2, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb35-6"><a href="activity-3.html#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="activity-3.html#cb35-7" tabindex="-1"></a>rmse.m3 <span class="ot">&lt;-</span> <span class="fu">rmse</span>(df.test<span class="sc">$</span>EGA, <span class="fu">as.numeric</span>(<span class="fu">predict</span>(m3, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb35-8"><a href="activity-3.html#cb35-8" tabindex="-1"></a>mae.m3 <span class="ot">&lt;-</span> <span class="fu">mae</span>(df.test<span class="sc">$</span>EGA, <span class="fu">as.numeric</span>(<span class="fu">predict</span>(m3, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb35-9"><a href="activity-3.html#cb35-9" tabindex="-1"></a></span>
<span id="cb35-10"><a href="activity-3.html#cb35-10" tabindex="-1"></a><span class="co">#m1 metrics</span></span>
<span id="cb35-11"><a href="activity-3.html#cb35-11" tabindex="-1"></a></span>
<span id="cb35-12"><a href="activity-3.html#cb35-12" tabindex="-1"></a>m1Metrics <span class="ot">&lt;-</span> df.test <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="activity-3.html#cb35-13" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb35-14"><a href="activity-3.html#cb35-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="fu">predict</span>(m1, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>), EGA), </span>
<span id="cb35-15"><a href="activity-3.html#cb35-15" tabindex="-1"></a><span class="at">fill =</span> <span class="st">&#39;purple4&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb35-16"><a href="activity-3.html#cb35-16" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb35-17"><a href="activity-3.html#cb35-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb35-18"><a href="activity-3.html#cb35-18" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb35-19"><a href="activity-3.html#cb35-19" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="dv">200</span>))<span class="sc">+</span>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-20"><a href="activity-3.html#cb35-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;m1&#39;</span>, <span class="at">x =</span> <span class="st">&#39;Predicted&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Observed&#39;</span>)<span class="sc">+</span></span>
<span id="cb35-21"><a href="activity-3.html#cb35-21" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;RMSE: &#39;</span>, <span class="fu">round</span>(rmse.m1,<span class="dv">1</span>)), <span class="at">x =</span> <span class="dv">700</span>, <span class="at">y =</span> <span class="dv">200</span>)<span class="sc">+</span></span>
<span id="cb35-22"><a href="activity-3.html#cb35-22" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;MAE: &#39;</span>, <span class="fu">round</span>(mae.m1,<span class="dv">1</span>)), <span class="at">x =</span> <span class="dv">700</span>, <span class="at">y =</span> <span class="dv">100</span>)<span class="sc">+</span></span>
<span id="cb35-23"><a href="activity-3.html#cb35-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-24"><a href="activity-3.html#cb35-24" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb35-25"><a href="activity-3.html#cb35-25" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb35-26"><a href="activity-3.html#cb35-26" tabindex="-1"></a>        )</span>
<span id="cb35-27"><a href="activity-3.html#cb35-27" tabindex="-1"></a></span>
<span id="cb35-28"><a href="activity-3.html#cb35-28" tabindex="-1"></a><span class="co">#m2 metrics</span></span>
<span id="cb35-29"><a href="activity-3.html#cb35-29" tabindex="-1"></a></span>
<span id="cb35-30"><a href="activity-3.html#cb35-30" tabindex="-1"></a>m2Metrics <span class="ot">&lt;-</span> df.test <span class="sc">%&gt;%</span> </span>
<span id="cb35-31"><a href="activity-3.html#cb35-31" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb35-32"><a href="activity-3.html#cb35-32" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="fu">predict</span>(m2, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>), EGA), </span>
<span id="cb35-33"><a href="activity-3.html#cb35-33" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&#39;purple4&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb35-34"><a href="activity-3.html#cb35-34" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb35-35"><a href="activity-3.html#cb35-35" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb35-36"><a href="activity-3.html#cb35-36" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb35-37"><a href="activity-3.html#cb35-37" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="dv">200</span>))<span class="sc">+</span>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-38"><a href="activity-3.html#cb35-38" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;m2&#39;</span>, <span class="at">x =</span> <span class="st">&#39;Predicted&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Observed&#39;</span>)<span class="sc">+</span></span>
<span id="cb35-39"><a href="activity-3.html#cb35-39" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;RMSE: &#39;</span>, <span class="fu">round</span>(rmse.m2,<span class="dv">1</span>)), <span class="at">x =</span> <span class="dv">700</span>, <span class="at">y =</span> <span class="dv">200</span>)<span class="sc">+</span></span>
<span id="cb35-40"><a href="activity-3.html#cb35-40" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;MAE: &#39;</span>, <span class="fu">round</span>(mae.m2,<span class="dv">1</span>)), <span class="at">x =</span> <span class="dv">700</span>, <span class="at">y =</span> <span class="dv">100</span>)<span class="sc">+</span></span>
<span id="cb35-41"><a href="activity-3.html#cb35-41" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-42"><a href="activity-3.html#cb35-42" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb35-43"><a href="activity-3.html#cb35-43" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb35-44"><a href="activity-3.html#cb35-44" tabindex="-1"></a>        )</span>
<span id="cb35-45"><a href="activity-3.html#cb35-45" tabindex="-1"></a></span>
<span id="cb35-46"><a href="activity-3.html#cb35-46" tabindex="-1"></a>m3Metrics <span class="ot">&lt;-</span> df.test <span class="sc">%&gt;%</span> </span>
<span id="cb35-47"><a href="activity-3.html#cb35-47" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb35-48"><a href="activity-3.html#cb35-48" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="fu">predict</span>(m3, df.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>), EGA), </span>
<span id="cb35-49"><a href="activity-3.html#cb35-49" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&#39;purple4&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb35-50"><a href="activity-3.html#cb35-50" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb35-51"><a href="activity-3.html#cb35-51" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb35-52"><a href="activity-3.html#cb35-52" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb35-53"><a href="activity-3.html#cb35-53" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb35-54"><a href="activity-3.html#cb35-54" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-55"><a href="activity-3.html#cb35-55" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;m3&#39;</span>, <span class="at">x =</span> <span class="st">&#39;Predicted&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Observed&#39;</span>)<span class="sc">+</span></span>
<span id="cb35-56"><a href="activity-3.html#cb35-56" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;RMSE: &#39;</span>, <span class="fu">round</span>(rmse.m3,<span class="dv">1</span>)), <span class="at">x =</span> <span class="dv">700</span>, <span class="at">y =</span> <span class="dv">200</span>)<span class="sc">+</span></span>
<span id="cb35-57"><a href="activity-3.html#cb35-57" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&#39;MAE: &#39;</span>, <span class="fu">round</span>(mae.m3,<span class="dv">1</span>)), <span class="at">x =</span> <span class="dv">700</span>, <span class="at">y =</span> <span class="dv">100</span>)<span class="sc">+</span></span>
<span id="cb35-58"><a href="activity-3.html#cb35-58" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-59"><a href="activity-3.html#cb35-59" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb35-60"><a href="activity-3.html#cb35-60" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb35-61"><a href="activity-3.html#cb35-61" tabindex="-1"></a>        )</span>
<span id="cb35-62"><a href="activity-3.html#cb35-62" tabindex="-1"></a></span>
<span id="cb35-63"><a href="activity-3.html#cb35-63" tabindex="-1"></a><span class="fu">ggarrange</span>(m1Metrics,m2Metrics, m3Metrics, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-12-1.png" width="1008" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="activity-3.html#cb36-1" tabindex="-1"></a></span>
<span id="cb36-2"><a href="activity-3.html#cb36-2" tabindex="-1"></a><span class="fu">AIC</span>(m1, m2, m3)</span>
<span id="cb36-3"><a href="activity-3.html#cb36-3" tabindex="-1"></a><span class="co">#&gt;          df      AIC</span></span>
<span id="cb36-4"><a href="activity-3.html#cb36-4" tabindex="-1"></a><span class="co">#&gt; m1 34.44604 3764.439</span></span>
<span id="cb36-5"><a href="activity-3.html#cb36-5" tabindex="-1"></a><span class="co">#&gt; m2 14.12373  980.207</span></span>
<span id="cb36-6"><a href="activity-3.html#cb36-6" tabindex="-1"></a><span class="co">#&gt; m3 39.79306 3313.507</span></span></code></pre></div>
</div>
<div id="summarize-your-results-using-words-numerical-values-and-figuresmaps." class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Summarize your results using words, numerical values and figures/maps.</h2>
<p>The three models were tested after splitting the data into testing and training through MAE and RMSE. In addition, AIC was compared. Both methods suggested that the model 2 was the best one. Below the predictions using the model 2 are presented for both years 2014 and 2015. The year 2014 resulted in very minimum abundance of EGA, while in 2015, the East region showed a high concentration of EGA.</p>
<p><img src="04-Activity_3_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Portfolio Stat 764</strong>" was written by Gabriel Hintz. It was last built on 2024-05-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
