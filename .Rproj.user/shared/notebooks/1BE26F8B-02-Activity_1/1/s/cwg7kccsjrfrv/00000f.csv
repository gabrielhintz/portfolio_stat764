"0","# Create data frame for plotting"
"0","df.pred2 <- df.pred %>% pivot_longer(cols = c(long.m1.hat,long.m2.hat), values_to = 'longitude', names_to = 'model') %>% "
"0","  pivot_longer(cols = c(lat.m1.hat, lat.m2.hat), values_to = 'latitude', names_to = 'model2') %>% "
"0","  mutate(model = substr(model, 6,7),"
"0","         model2 = substr(model2, 5,6)) %>% "
"0","  filter(model == model2) %>% dplyr::select(-c(ele.m1.hat, ele.m2.hat, model2))"
"0",""
"0","# Visualize models"
"0",""
"0","color_palette <- colorFactor(palette = ""Set1"", domain = df.pred2$model)"
"0",""
"0","leaflet(df.pred2) %>%"
"0","  addTiles(group = ""OSM (default)"") %>%"
"0","  addProviderTiles(providers$Esri.WorldImagery, group = ""World Imagery"") %>%"
"0","  addCircleMarkers("
"0","    ~longitude,"
"0","    ~latitude,"
"0","    fillColor = ~color_palette(model), "
"0","    color = ~'black', # This will set the border color the same as the fill color"
"0","    radius = 3,"
"0","    weight = 1,"
"0","    fillOpacity = 0.8,"
"0","    stroke = TRUE, # Set to TRUE to have borders on the circles"
"0","    group = ""Data Points"""
"0","  ) %>%"
"0","  addLayersControl("
"0","    baseGroups = c(""OSM (default)"", ""World Imagery""),"
"0","    overlayGroups = c(""Data Points""),"
"0","    options = layersControlOptions(collapsed = FALSE)"
"0","  ) %>%"
"0","  addLegend("
"0","    position = ""bottomright"","
"0","    pal = color_palette,"
"0","    values = ~model,"
"0","    title = ""Model"","
"0","    opacity = 1.0"
"0","  )"
